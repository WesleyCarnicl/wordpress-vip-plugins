!function(e){e(function(){function t(){var t={body:e("body"),revenueModel:".lp_js_revenueModel",revenueModelLabel:".lp_js_revenueModelLabel",revenueModelLabelDisplay:".lp_js_revenueModelLabelDisplay",revenueModelInput:".lp_js_revenueModelInput",priceInput:".lp_js_priceInput",emptyState:".lp_js_emptyState",purchaseModeForm:e("#lp_js_changePurchaseModeForm"),purchaseModeInput:e(".lp_js_onlyTimePassPurchaseModeInput"),timePassOnlyHideElements:e(".lp_js_hideInTimePassOnlyMode"),globalDefaultPriceForm:e("#lp_js_globalDefaultPriceForm"),globalDefaultPriceInput:e("#lp_js_globalDefaultPriceInput"),globalDefaultPriceDisplay:e("#lp_js_globalDefaultPriceDisplay"),globalDefaultPriceRevenueModelDisplay:e("#lp_js_globalDefaultPriceRevenueModelDisplay"),editGlobalDefaultPrice:e("#lp_js_editGlobalDefaultPrice"),cancelEditingGlobalDefaultPrice:e("#lp_js_cancelEditingGlobalDefaultPrice"),saveGlobalDefaultPrice:e("#lp_js_saveGlobalDefaultPrice"),globalDefaultPriceShowElements:e("#lp_js_globalDefaultPriceShowElements"),globalDefaultPriceEditElements:e("#lp_js_globalDefaultPriceEditElements"),categoryDefaultPrices:e("#lp_js_categoryDefaultPriceList"),addCategory:e("#lp_js_addCategoryDefaultPrice"),categoryDefaultPriceTemplate:e("#lp_js_categoryDefaultPriceTemplate"),categoryDefaultPriceForm:".lp_js_categoryDefaultPriceForm",editCategoryDefaultPrice:".lp_js_editCategoryDefaultPrice",cancelEditingCategoryDefaultPrice:".lp_js_cancelEditingCategoryDefaultPrice",saveCategoryDefaultPrice:".lp_js_saveCategoryDefaultPrice",deleteCategoryDefaultPrice:".lp_js_deleteCategoryDefaultPrice",categoryDefaultPriceShowElements:".lp_js_categoryDefaultPriceShowElements",categoryDefaultPriceEditElements:".lp_js_categoryDefaultPriceEditElements",categoryTitle:".lp_js_categoryDefaultPriceCategoryTitle",categoryDefaultPriceDisplay:".lp_js_categoryDefaultPriceDisplay",selectCategory:".lp_js_selectCategory",categoryDefaultPriceInput:".lp_js_categoryDefaultPriceInput",categoryId:".lp_js_categoryDefaultPriceCategoryId",timepass:{editor:e("#lp_time-passes"),template:e("#lp_js_timePassTemplate"),form:".lp_js_timePassEditorForm",editorContainer:".lp_js_timePassEditorContainer",id:".lp_js_timePassId",wrapper:".lp_js_timePassWrapper",categoryWrapper:".lp_js_timePassCategoryWrapper",fields:{duration:".lp_js_switchTimePassDuration",period:".lp_js_switchTimePassPeriod",scope:".lp_js_switchTimePassScope",scopeCategory:".lp_js_switchTimePassScopeCategory",categoryId:".lp_js_timePassCategoryId",title:".lp_js_timePassTitleInput",price:".lp_js_timePassPriceInput",revenueModel:".lp_js_timePassRevenueModelInput",description:".lp_js_timePassDescriptionTextarea"},classes:{form:"lp_js_timePassForm",editorForm:"lp_js_timePassEditorForm",durationClass:"lp_js_switchTimePassDuration",titleClass:"lp_js_timePassTitleInput",priceClass:"lp_js_timePassPriceInput",descriptionClass:"lp_js_timePassDescriptionTextarea",periodClass:"lp_js_switchTimePassPeriod",scopeClass:"lp_js_switchTimePassScope",scopeCategoryClass:"lp_js_switchTimePassScopeCategory"},preview:{placeholder:".lp_js_timePassPreview",wrapper:".lp_js_timePass",title:".lp_js_timePassPreviewTitle",description:".lp_js_timePassPreviewDescription",validity:".lp_js_timePassPreviewValidity",access:".lp_js_timePassPreviewAccess",price:".lp_js_timePassPreviewPrice"},actions:{create:e("#lp_js_addTimePass"),show:".lp_js_saveTimePass, .lp_js_cancelEditingTimePass",modify:".lp_js_editTimePass, .lp_js_deleteTimePass",save:".lp_js_saveTimePass",cancel:".lp_js_cancelEditingTimePass","delete":".lp_js_deleteTimePass",edit:".lp_js_editTimePass",flip:".lp_js_flipTimePass"},ajax:{form:{"delete":"time_pass_delete"}},data:{id:"pass-id",list:lpVars.time_passes_list,vouchers:lpVars.vouchers_list,deleteConfirm:lpVars.i18n.confirmDeleteTimepass,fields:{id:"pass_id"}}},subscription:{editor:e("#lp_subscriptions"),template:e("#lp_js_subscriptionTemplate"),form:".lp_js_subscriptionEditorForm",editorContainer:".lp_js_subscriptionEditorContainer",id:".lp_js_subscriptionId",wrapper:".lp_js_subscriptionWrapper",categoryWrapper:".lp_js_subscriptionCategoryWrapper",fields:{duration:".lp_js_switchSubscriptionDuration",period:".lp_js_switchSubscriptionPeriod",scope:".lp_js_switchSubscriptionScope",scopeCategory:".lp_js_switchSubscriptionScopeCategory",categoryId:".lp_js_subscriptionCategoryId",title:".lp_js_subscriptionTitleInput",price:".lp_js_subscriptionPriceInput",description:".lp_js_subscriptionDescriptionTextarea"},classes:{form:"lp_js_subscriptionForm",editorForm:"lp_js_subscriptionEditorForm",durationClass:"lp_js_switchSubscriptionDuration",titleClass:"lp_js_subscriptionTitleInput",priceClass:"lp_js_subscriptionPriceInput",descriptionClass:"lp_js_subscriptionDescriptionTextarea",periodClass:"lp_js_switchSubscriptionPeriod",scopeClass:"lp_js_switchSubscriptionScope",scopeCategoryClass:"lp_js_switchSubscriptionScopeCategory"},preview:{placeholder:".lp_js_subscriptionPreview",wrapper:".lp_js_subscription",title:".lp_js_subscriptionPreviewTitle",description:".lp_js_subscriptionPreviewDescription",validity:".lp_js_subscriptionPreviewValidity",access:".lp_js_subscriptionPreviewAccess",price:".lp_js_subscriptionPreviewPrice",renewal:".lp_js_subscriptionPreviewRenewal"},actions:{create:e("#lp_js_addSubscription"),show:".lp_js_saveSubscription, .lp_js_cancelEditingSubscription",modify:".lp_js_editSubscription, .lp_js_deleteSubscription",save:".lp_js_saveSubscription",edit:".lp_js_editSubscription",cancel:".lp_js_cancelEditingSubscription","delete":".lp_js_deleteSubscription",flip:".lp_js_flipSubscription"},ajax:{form:{"delete":"subscription_delete"}},data:{id:"sub-id",list:lpVars.subscriptions_list,deleteConfirm:lpVars.i18n.confirmDeleteSubscription,fields:{id:"id"}}},voucherPriceInput:".lp_js_voucherPriceInput",generateVoucherCode:".lp_js_generateVoucherCode",voucherDeleteLink:".lp_js_deleteVoucher",voucherEditor:".lp_js_voucherEditor",voucherHiddenPassId:"#lp_js_timePassEditorHiddenPassId",voucherPlaceholder:".lp_js_voucherPlaceholder",voucherList:".lp_js_voucherList",voucher:".lp_js_voucher",voucherTimesRedeemed:".lp_js_voucherTimesRedeemed",editing:"lp_is-editing",unsaved:"lp_is-unsaved",payPerUse:"ppu",singleSale:"sis",selected:"lp_is-selected",disabled:"lp_is-disabled",hidden:"lp_hidden",navigation:e(".lp_navigation")},i=function(){t.body.on("change",t.revenueModelInput,function(){s(e(this).parents("form"))}),t.body.on("keyup",t.priceInput,V(function(){s(e(this).parents("form"))},1500)),t.purchaseModeInput.on("change",function(){E(t.purchaseModeForm)}),t.editGlobalDefaultPrice.on("mousedown",function(){r()}).click(function(e){e.preventDefault()}),t.cancelEditingGlobalDefaultPrice.on("mousedown",function(){o()}).click(function(e){e.preventDefault()}),t.saveGlobalDefaultPrice.on("mousedown",function(){l()}).click(function(e){e.preventDefault()}),t.addCategory.on("mousedown",function(){n()}).click(function(e){e.preventDefault()}),t.body.on("click",t.editCategoryDefaultPrice,function(){var i=e(this).parents(t.categoryDefaultPriceForm);c(i)}),t.body.on("click",t.cancelEditingCategoryDefaultPrice,function(){var i=e(this).parents(t.categoryDefaultPriceForm);u(i)}),t.body.on("click",t.saveCategoryDefaultPrice,function(){var i=e(this).parents(t.categoryDefaultPriceForm);p(i)}),t.body.on("click",t.deleteCategoryDefaultPrice,function(){var i=e(this).parents(t.categoryDefaultPriceForm);d(i)}),t.timepass.actions.create.on("mousedown",function(){v("timepass")}).on("click",function(e){e.preventDefault()}),t.timepass.editor.on("mousedown",t.timepass.actions.edit,function(){h("timepass",e(this).parents(t.timepass.wrapper))}).on("click",t.timepass.actions.edit,function(e){e.preventDefault()}),t.timepass.editor.on("change",t.timepass.fields.revenueModel,function(){var i=e(this).parents("form");s(i,!1,e(t.timepass.fields.price,i))}),t.timepass.editor.on("change",t.timepass.fields.duration,function(){g("timepass",e(this).parents(t.timepass.wrapper),e(this))}),t.timepass.editor.on("change",t.timepass.fields.period,function(){C("timepass",e(this),e(this).parents(t.timepass.wrapper)),g("timepass",e(this).parents(t.timepass.wrapper),e(this))}),t.timepass.editor.on("change",t.timepass.fields.scope,function(){w("timepass",e(this)),g("timepass",e(this).parents(t.timepass.wrapper),e(this))}),t.timepass.editor.on("change",t.timepass.fields.scopeCategory,function(){g("timepass",e(this).parents(t.timepass.wrapper),e(this))}),t.timepass.editor.on("input",[t.timepass.fields.title,t.timepass.fields.description].join(),function(){g("timepass",e(this).parents(t.timepass.wrapper),e(this))}),t.timepass.editor.on("keyup",t.timepass.fields.price,V(function(){s(e(this).parents("form"),!1,e(this)),g("timepass",e(this).parents(t.timepass.wrapper),e(this))},1500)),t.timepass.editor.on("click",t.timepass.actions.cancel,function(i){b("timepass",e(this).parents(t.timepass.wrapper)),i.preventDefault()}),t.timepass.editor.on("click",t.timepass.actions.save,function(i){P("timepass",e(this).parents(t.timepass.wrapper)),i.preventDefault()}),t.timepass.editor.on("click",t.timepass.actions["delete"],function(i){j("timepass",e(this).parents(t.timepass.wrapper)),i.preventDefault()}),t.timepass.editor.on("mousedown",t.timepass.actions.flip,function(){D("timepass",this)}).on("click",t.timepass.actions.flip,function(e){e.preventDefault()}),t.timepass.editor.on("keyup",t.voucherPriceInput,V(function(){s(e(this).parents("form"),!0,e(this))},1500)),t.timepass.editor.on("mousedown",t.generateVoucherCode,function(){x(e(this).parents(t.timepass.wrapper))}).on("click",t.generateVoucherCode,function(e){e.preventDefault()}),t.timepass.editor.on("click",t.voucherDeleteLink,function(t){M(e(this).parent()),t.preventDefault()}),t.subscription.actions.create.on("mousedown",function(){v("subscription")}).on("click",function(e){e.preventDefault()}),t.subscription.editor.on("mousedown",t.subscription.actions.edit,function(){h("subscription",e(this).parents(t.subscription.wrapper))}).on("click",t.subscription.actions.edit,function(e){e.preventDefault()}),t.subscription.editor.on("change",t.subscription.fields.duration,function(){g("subscription",e(this).parents(t.subscription.wrapper),e(this))}),t.subscription.editor.on("change",t.subscription.fields.period,function(){C("subscription",e(this),e(this).parents(t.subscription.wrapper)),g("subscription",e(this).parents(t.subscription.wrapper),e(this))}),t.subscription.editor.on("change",t.subscription.fields.scope,function(){w("subscription",e(this)),g("subscription",e(this).parents(t.subscription.wrapper),e(this))}),t.subscription.editor.on("change",t.subscription.fields.scopeCategory,function(){g("subscription",e(this).parents(t.subscription.wrapper),e(this))}),t.subscription.editor.on("input",[t.subscription.fields.title,t.subscription.fields.description].join(),function(){g("subscription",e(this).parents(t.subscription.wrapper),e(this))}),t.subscription.editor.on("keyup",t.subscription.fields.price,V(function(){s(e(this).parents("form"),!0,e(this),!0),g("subscription",e(this).parents(t.subscription.wrapper),e(this))},1500)),t.subscription.editor.on("click",t.subscription.actions.cancel,function(i){b("subscription",e(this).parents(t.subscription.wrapper)),i.preventDefault()}),t.subscription.editor.on("click",t.subscription.actions.save,function(i){P("subscription",e(this).parents(t.subscription.wrapper)),i.preventDefault()}),t.subscription.editor.on("click",t.subscription.actions["delete"],function(i){j("subscription",e(this).parents(t.subscription.wrapper)),i.preventDefault()}),t.subscription.editor.on("mousedown",t.subscription.actions.flip,function(){D("subscription",this)}).on("click",t.subscription.actions.flip,function(e){e.preventDefault()})},s=function(t,i,s,r){var o=s?s:e(".lp_number-input",t),l=o.val();return l=l.replace(/[^0-9\,\.]/g,""),l=parseFloat(l.replace(",",".")).toFixed(2),isNaN(l)&&(l=0),l=Math.abs(l),r?l<lpVars.currency.sis_min?l=lpVars.currency.sis_min:l>lpVars.currency.sis_max&&(l=lpVars.currency.sis_max):l>lpVars.currency.sis_max?l=lpVars.currency.sis_max:l>0&&l<lpVars.currency.ppu_min&&(l=lpVars.currency.ppu_min),i||a(l,t),l=l.toFixed(2),lpVars.locale.indexOf("de_DE")!==-1&&(l=l.replace(".",",")),o.val(l),l},a=function(i,s){var a,r=t.revenueModelInput;s.hasClass(t.timepass.classes.editorForm)&&(r=t.timepass.fields.revenueModel);var o=e(r+"[value="+t.payPerUse+"]",s),l=e(r+"[value="+t.singleSale+"]",s);a=e("input:radio:checked",s).val(),0===i||i>=lpVars.currency.ppu_min&&i<=lpVars.currency.ppu_max?(o.removeProp("disabled").parent("label").removeClass(t.disabled),l.parent("label").attr("data-tooltip",lpVars.i18n.payNowToolTip),l.parent("label").addClass("lp_tooltip"),o.parent("label").removeClass("lp_tooltip")):o.prop("disabled","disabled").parent("label").addClass(t.disabled),i>=lpVars.currency.sis_min?(l.removeProp("disabled").parent("label").removeClass(t.disabled),o.parent("label").attr("data-tooltip",lpVars.i18n.payLaterToolTip),o.parent("label").addClass("lp_tooltip"),l.parent("label").removeClass("lp_tooltip")):l.prop("disabled","disabled").parent("label").addClass(t.disabled),i>lpVars.currency.ppu_max&&a===t.payPerUse?l.prop("checked","checked"):i<lpVars.currency.sis_min&&a===t.singleSale&&o.prop("checked","checked"),e("label",s).removeClass(t.selected),e(r+":checked",s).parent("label").addClass(t.selected)},r=function(){t.globalDefaultPriceShowElements.velocity("slideUp",{duration:250,easing:"ease-out"}),t.globalDefaultPriceEditElements.velocity("slideDown",{duration:250,easing:"ease-out",complete:function(){setTimeout(function(){t.globalDefaultPriceInput.focus()},50)}}),t.globalDefaultPriceForm.addClass(t.editing)},o=function(){t.globalDefaultPriceShowElements.velocity("slideDown",{duration:250,easing:"ease-out"}),t.globalDefaultPriceEditElements.velocity("slideUp",{duration:250,easing:"ease-out"}),t.globalDefaultPriceForm.removeClass(t.editing),t.globalDefaultPriceInput.val(t.globalDefaultPriceDisplay.data("price"));var i=t.globalDefaultPriceRevenueModelDisplay.data("revenue");e(t.revenueModelLabel,t.globalDefaultPriceForm).removeClass(t.selected),e(".lp_js_revenueModelInput[value="+i+"]",t.globalDefaultPriceForm).prop("checked","checked").parent("label").addClass(t.selected)},l=function(){var i=s(t.globalDefaultPriceForm);t.globalDefaultPriceInput.val(i),e.post(ajaxurl,t.globalDefaultPriceForm.serializeArray(),function(e){e.success&&(t.globalDefaultPriceDisplay.text(e.localized_price).data("price",e.price),t.globalDefaultPriceRevenueModelDisplay.text(e.revenue_model_label).data("revenue",e.revenue_model)),t.navigation.showMessage(e),o()},"json")},n=function(){t.addCategory.velocity("fadeOut",{duration:250}),e(t.emptyState,t.categoryDefaultPrices).is(":visible")&&e(t.emptyState,t.categoryDefaultPrices).velocity("fadeOut",{duration:400});var i=t.categoryDefaultPriceTemplate.clone().removeAttr("id").insertBefore("#lp_js_categoryDefaultPriceList").velocity("slideDown",{duration:250,easing:"ease-out"});c(i)},c=function(i){e(".lp_js_categoryDefaultPriceForm.lp_is-editing").each(function(){u(e(this),!0)}),i.addClass(t.editing),e(t.categoryDefaultPriceShowElements,i).velocity("slideUp",{duration:250,easing:"ease-out"}),t.addCategory.velocity("fadeOut",{duration:250}),e(t.categoryDefaultPriceEditElements,i).velocity("slideDown",{duration:250,easing:"ease-out",complete:function(){e(t.categoryDefaultPriceInput,i).focus()}}),m(i,t.selectCategory,"laterpay_get_categories_with_price",f)},p=function(i){var a=s(i);e(t.categoryDefaultPriceInput,i).val(a),e.post(ajaxurl,i.serializeArray(),function(s){s.success&&(e(t.categoryDefaultPriceDisplay,i).text(s.localized_price).data("price",s.price),e(t.revenueModelLabelDisplay,i).text(s.revenue_model_label).data("revenue",s.revenue_model),e(t.categoryDefaultPriceInput,i).val(s.price),e(t.categoryTitle,i).text(s.category),e(t.categoryId,i).val(s.category_id),i.removeClass(t.unsaved)),u(i),t.navigation.showMessage(s)},"json")},u=function(i,s){if(i.removeClass(t.editing),i.hasClass(t.unsaved))i.velocity("slideUp",{duration:250,easing:"ease-out",complete:function(){e(this).remove(),0===e(t.categoryDefaultPriceForm+":visible").length&&e(t.emptyState,t.categoryDefaultPrices).velocity("fadeIn",{duration:400})}});else{e(t.categoryDefaultPriceEditElements,i).velocity("slideUp",{duration:250,easing:"ease-out"}),e(t.selectCategory,i).select2("destroy"),e(t.categoryDefaultPriceInput,i).val(e(t.categoryDefaultPriceDisplay,i).data("price"));var a=e(t.revenueModelLabelDisplay,i).data("revenue");e(t.revenueModelLabel,i).removeClass(t.selected),e(".lp_js_revenueModelInput[value="+a+"]",i).prop("checked","checked").parent("label").addClass(t.selected),e(t.categoryDefaultPriceShowElements,i).velocity("slideDown",{duration:250,easing:"ease-out"})}s||t.addCategory.velocity("fadeIn",{duration:250,display:"inline-block"})},d=function(i){s(i,!1,e("input[name=price]",i)),e("input[name=form]",i).val("price_category_form_delete"),e.post(ajaxurl,i.serializeArray(),function(s){s.success&&i.velocity("slideUp",{duration:250,easing:"ease-out",complete:function(){e(this).remove(),0===e(t.categoryDefaultPriceForm+":visible").length&&e(t.emptyState,t.categoryDefaultPrices).velocity("fadeIn",{duration:400})}}),t.navigation.showMessage(s)},"json")},f=function(t,i){var s=e(i).parent().parent().parent();return e(".lp_js_selectCategory",s).val(t.text),e(".lp_js_categoryDefaultPriceCategoryId",s).val(t.id),t.text},_=function(i,s){var a=e(s).parents("form"),r=t.timepass;return e(a).hasClass(t.subscription.classes.editorForm)&&(r=t.subscription),i.id&&e(r.fields.categoryId,e(a)).val(i.id),e(r.fields.scopeCategory,e(a)).val(i.text),i.text},m=function(t,i,s,a){e(i,t).select2({allowClear:!0,ajax:{url:ajaxurl,data:function(e){return{form:s,term:e,action:"laterpay_pricing"}},results:function(t){var i=[];return e.each(t.categories,function(e){var s=t.categories[e];i.push({id:s.term_id,text:s.name})}),{results:i}},dataType:"json",type:"POST"},initSelection:function(t,i){var a=e(t).val();if(""!==a){var r={text:a};i(r)}else e.post(ajaxurl,{form:s,term:"",action:"laterpay_pricing"},function(e){if(e&&void 0!==e[0]){var t=e[0];i({id:t.term_id,text:t.name})}})},formatResult:function(e){return e.text},formatSelection:a,escapeMarkup:function(e){return e}})},v=function(i){var s=t[i];s.actions.create.velocity("fadeOut",{duration:250}),e(t.emptyState,s.editor).is(":visible")&&e(t.emptyState,s.editor).velocity("fadeOut",{duration:400}),e(s.wrapper).first().before(s.template.clone().removeAttr("id"));var a=e(s.wrapper,s.editor).first();e(s.form,a).addClass(t.unsaved),y(i,a),a.velocity("slideDown",{duration:250,easing:"ease-out",complete:function(){e(this).removeClass(t.hidden)}}).find(s.form).velocity("slideDown",{duration:250,easing:"ease-out",complete:function(){e(this).removeClass(t.hidden)}})},h=function(i,s){var a=t[i],r=e(a.form,a.template).clone();e(a.editorContainer,s).empty().append(r),y(i,s),e(a.actions.modify,s).addClass(t.hidden),e(a.actions.show,s).removeClass(t.hidden),r.removeClass(t.hidden)},y=function(i,a){var r=t[i],o=a.data(r.data.id),l=r.data.list[o],n="";if(l){if(e("input, select, textarea",a).each(function(t,i){n=e(i,a).attr("name"),""!==n&&void 0!==l[n]&&"revenue_model"!==n&&e(i,a).val(l[n])}),"timepass"===i){var c=r.data.vouchers[o];s(a.find("form"),!1,e(r.fields.price,a)),e(t.voucherPriceInput,a).val(e(r.fields.price,a).val()),e(t.revenueModelLabel,a).removeClass(t.selected);var p=e(r.fields.revenueModel+"[value="+l.revenue_model+"]",a);p.prop("checked","checked"),p.parent("label").addClass(t.selected),k(a),c instanceof Object&&e.each(c,function(e,t){T(e,t,a)})}else"subscription"===i&&s(a.find("form"),!0,e(r.fields.price,a));e(r.categoryWrapper,a).hide(),m(a,r.fields.scopeCategory,"laterpay_get_categories",_);var u=e(r.fields.scope,a).find("option:selected");"0"!==u.val()&&e(r.categoryWrapper,a).show()}},g=function(i,s,a){var r=t[i],o=""!==a.val()?a.val():" ";if(a.hasClass(r.classes.durationClass)||a.hasClass(r.classes.periodClass)){var l=e(r.fields.duration,s).val(),n=e(r.fields.period,s).find("option:selected").text();n=parseInt(l,10)>1?n+"s":n,o=l+" "+n,e(r.preview.validity,s).text(o),"subscription"===i&&e(r.preview.renewal,s).text(lpVars.i18n.after+" "+o)}else if(a.hasClass(r.classes.scopeClass)||a.hasClass(r.classes.scopeCategoryClass)){var c=e(r.fields.scope,s).find("option:selected");o=c.text(),"0"!==c.val()&&(o+=" "+e(r.fields.scopeCategory,s).val()),e(r.preview.access,s).text(o)}else if(a.hasClass(r.classes.priceClass)){var p=e("<small />",{"class":"lp_purchase-link__currency"});p.text(lpVars.currency.code),e(".lp_js_purchaseLink",s).empty().append(o).append(p),e(r.preview.price).text(o+" "+lpVars.currency.code)}else a.hasClass(r.classes.titleClass)?e(r.preview.title,s).text(o):a.hasClass(r.classes.descriptionClass)&&e(r.preview.description,s).text(o)},b=function(i,s){var a=t[i],r=s.find(a.preview.wrapper).data(a.data.id);e(a.form,s).hasClass(t.unsaved)?s.velocity("fadeOut",{duration:250,complete:function(){e(this).remove(),0===e(a.wrapper+":visible").length&&e(t.emptyState,a.editor).velocity("fadeIn",{duration:400})}}):e(a.form,s).velocity("fadeOut",{duration:250,complete:function(){e(this).remove()}}),e(a.actions.modify,s).removeClass(t.hidden),e(a.actions.show,s).addClass(t.hidden),"timepass"===i&&(k(s),a.data.vouchers[r]instanceof Object&&(e.each(a.data.vouchers[r],function(e,t){S(e,t,s)}),s.find(t.voucherList).show())),a.actions.create.is(":hidden")&&a.actions.create.velocity("fadeIn",{duration:250,display:"inline-block"})},P=function(i,s){var a=t[i];e.post(ajaxurl,e(a.form,s).serializeArray(),function(r){if(r.success){var o=r.data[a.data.fields.id];"timepass"===i&&(a.data.vouchers[o]=r.vouchers),a.data.list[o]||(s.data(a.data.id,o),e(a.id,s).text(o).parent().velocity("fadeIn",{duration:250})),a.data.list[o]=r.data,e(a.preview.placeholder,s).empty().append(r.html),e(a.actions.show,s).addClass(t.hidden),e(a.actions.modify,s).removeClass(t.hidden),e(a.form,s).velocity("fadeOut",{duration:250,complete:function(){e(this).remove(),"timepass"===i&&I(s,a,o)}}),a.actions.create.is(":hidden")&&a.actions.create.velocity("fadeIn",{duration:250,display:"inline-block"})}t.navigation.showMessage(r)},"json")},j=function(i,s){var a=t[i];confirm(a.data.deleteConfirm)&&s.velocity("slideUp",{duration:250,easing:"ease-out",begin:function(){e.post(ajaxurl,{action:"laterpay_pricing",form:a.ajax.form["delete"],id:s.data(a.data.id)},function(i){i.success?(s.remove(),0===e(a.wrapper+":visible").length&&(e(t.emptyState,a.editor).velocity("fadeIn",{duration:400}),"1"===i.purchase_mode_value?t.purchaseModeInput.prop("checked",!0):t.purchaseModeInput.prop("checked",!1))):e(this).stop().show(),t.navigation.showMessage(i)},"json")}})},D=function(i,s){e(s).parents(t[i].preview.wrapper).toggleClass("lp_is-flipped")},w=function(i,s){var a=t[i],r=e("option:selected",s).val();"0"===r?e(a.categoryWrapper).hide():e(a.categoryWrapper).show()},C=function(i,s,a){var r,o=t[i],l=[],n=24,c=s.val(),p=e(o.fields.duration,a).val();for("4"===c?n=1:"3"===c&&(n=12),r=1;r<=n;r++){var u=e("<option/>",{value:r});u.text(r),l.push(u)}e(o.fields.duration,a).find("option").remove().end().append(l).val(p&&p<=n?p:1)},I=function(i,s,a){k(i),s.data.vouchers[a]instanceof Object&&(e.each(s.data.vouchers[a],function(e,t){S(e,t,i)}),i.find(t.voucherList).show())},x=function(i){e.post(ajaxurl,{form:"generate_voucher_code",action:"laterpay_pricing",price:i.find(t.voucherPriceInput).val()},function(e){e.success?T(e.code,i.find(t.voucherPriceInput).val(),i):t.navigation.showMessage(e)},"json")},T=function(i,s,a){var r=s.price?s.price:s,o=r+" "+lpVars.currency.code,l=s.title?s.title:"",n=e("<div/>",{"class":"lp_js_voucher lp_voucher","data-code":i,style:"display:none;"}),c=e("<input/>",{type:"hidden",name:"voucher_code[]",value:i}),p=e("<input/>",{type:"hidden",name:"voucher_price[]",value:r}),u=e("<span/>",{"class":"lp_voucher__code"}).text(i),d=e("<span/>",{"class":"lp_voucher__code-infos"}).text(lpVars.i18n.voucherText+" "+o),f=e("<input/>",{"class":"lp_input__title",type:"text",name:"voucher_title[]",value:l}),_=e("<a/>",{"class":"lp_js_deleteVoucher lp_edit-link--bold","data-icon":"g"});n.empty().append(c).append(p).append(u).append(d).append(f).append(_),a.find(t.voucherPlaceholder).prepend(n).find("div").first().velocity("slideDown",{duration:250,easing:"ease-out"})},S=function(i,s,a){var r=a.data(t.timepass.data.id),o=lpVars.vouchers_statistic[r]?lpVars.vouchers_statistic[r]:0,l=s.title?s.title:"",n=s.price+" "+lpVars.currency.code,c=e("<div/>",{"class":"lp_js_voucher lp_voucher","data-code":i}),p=e("<span/>",{"class":"lp_voucher__title"}).append(e("<b/>").text(l)),u=e("<span/>",{"class":"lp_voucher__code"}).text(i),d=e("<span/>",{"class":"lp_voucher__code-infos"}).text(lpVars.i18n.voucherText+" "+n).append("<br/>").append(e("<span/>",{"class":"lp_js_voucherTimesRedeemed"}).text(o)).append(" "+lpVars.i18n.timesRedeemed),f=e("<div/>").append(u).append(d);c.append(p).append(f),a.find(t.voucherList).append(c)},k=function(e){e.find(t.voucher).remove()},M=function(t){t.velocity("slideUp",{duration:250,easing:"ease-out",complete:function(){e(this).remove()}})},E=function(i){var s=i.serialize();t.purchaseModeInput.prop("disabled",!0),e.post(ajaxurl,s,function(e){e.success||(t.navigation.showMessage(e),t.purchaseModeInput.prop("checked",!1))},"json"),t.purchaseModeInput.prop("disabled",!1)},V=function(e,t){var i;return function(){var s=this,a=arguments;clearTimeout(i),i=setTimeout(function(){e.apply(s,a)},t)}},F=function(){i()};F()}t()})}(jQuery);