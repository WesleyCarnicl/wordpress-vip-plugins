!function(e){e(function(){function i(){var i={body:e("body"),revenueModel:".lp_js_revenueModel",revenueModelLabel:".lp_js_revenueModelLabel",revenueModelLabelDisplay:".lp_js_revenueModelLabelDisplay",revenueModelInput:".lp_js_revenueModelInput",priceInput:".lp_js_priceInput",emptyState:".lp_js_emptyState",timePassOnlyHideElements:e(".lp_js_hideInTimePassOnlyMode"),globalDefaultPriceForm:e("#lp_js_globalDefaultPriceForm"),globalDefaultPriceInput:e("#lp_js_globalDefaultPriceInput"),globalDefaultPriceDisplay:e("#lp_js_globalDefaultPriceDisplay"),globalDefaultPriceRevenueModelDisplay:e("#lp_js_globalDefaultPriceRevenueModelDisplay"),editGlobalDefaultPrice:e("#lp_js_editGlobalDefaultPrice"),cancelEditingGlobalDefaultPrice:e("#lp_js_cancelEditingGlobalDefaultPrice"),saveGlobalDefaultPrice:e("#lp_js_saveGlobalDefaultPrice"),globalDefaultPriceShowElements:e("#lp_js_globalDefaultPriceShowElements"),globalDefaultPriceEditElements:e("#lp_js_globalDefaultPriceEditElements"),categoryDefaultPrices:e("#lp_js_categoryDefaultPriceList"),addCategory:e("#lp_js_addCategoryDefaultPrice"),categoryDefaultPriceTemplate:e("#lp_js_categoryDefaultPriceTemplate"),categoryDefaultPriceForm:".lp_js_categoryDefaultPriceForm",editCategoryDefaultPrice:".lp_js_editCategoryDefaultPrice",cancelEditingCategoryDefaultPrice:".lp_js_cancelEditingCategoryDefaultPrice",saveCategoryDefaultPrice:".lp_js_saveCategoryDefaultPrice",deleteCategoryDefaultPrice:".lp_js_deleteCategoryDefaultPrice",categoryDefaultPriceShowElements:".lp_js_categoryDefaultPriceShowElements",categoryDefaultPriceEditElements:".lp_js_categoryDefaultPriceEditElements",categoryTitle:".lp_js_categoryDefaultPriceCategoryTitle",categoryDefaultPriceDisplay:".lp_js_categoryDefaultPriceDisplay",selectCategory:".lp_js_selectCategory",categoryDefaultPriceInput:".lp_js_categoryDefaultPriceInput",categoryId:".lp_js_categoryDefaultPriceCategoryId",timepass:{editor:e("#lp_time-passes"),template:e("#lp_js_timePassTemplate"),form:".lp_js_timePassEditorForm",editorContainer:".lp_js_timePassEditorContainer",id:".lp_js_timePassId",wrapper:".lp_js_timePassWrapper",categoryWrapper:".lp_js_timePassCategoryWrapper",fields:{duration:".lp_js_switchTimePassDuration",period:".lp_js_switchTimePassPeriod",scope:".lp_js_switchTimePassScope",scopeCategory:".lp_js_switchTimePassScopeCategory",categoryId:".lp_js_timePassCategoryId",title:".lp_js_timePassTitleInput",price:".lp_js_timePassPriceInput",revenueModel:".lp_js_timePassRevenueModelInput",description:".lp_js_timePassDescriptionTextarea"},classes:{form:"lp_js_timePassForm",editorForm:"lp_js_timePassEditorForm",durationClass:"lp_js_switchTimePassDuration",titleClass:"lp_js_timePassTitleInput",priceClass:"lp_js_timePassPriceInput",descriptionClass:"lp_js_timePassDescriptionTextarea",periodClass:"lp_js_switchTimePassPeriod",scopeClass:"lp_js_switchTimePassScope",scopeCategoryClass:"lp_js_switchTimePassScopeCategory"},preview:{placeholder:".lp_js_timePassPreview",wrapper:".lp_js_timePass",title:".lp_js_timePassPreviewTitle",description:".lp_js_timePassPreviewDescription",validity:".lp_js_timePassPreviewValidity",access:".lp_js_timePassPreviewAccess",price:".lp_js_timePassPreviewPrice"},actions:{create:e("#lp_js_addTimePass"),show:".lp_js_saveTimePass, .lp_js_cancelEditingTimePass",modify:".lp_js_editTimePass, .lp_js_deleteTimePass",save:".lp_js_saveTimePass",cancel:".lp_js_cancelEditingTimePass","delete":".lp_js_deleteTimePass",edit:".lp_js_editTimePass",flip:".lp_js_flipTimePass"},ajax:{form:{"delete":"time_pass_delete"}},data:{id:"pass-id",list:lpVars.time_passes_list,vouchers:lpVars.vouchers_list,deleteConfirm:lpVars.i18n.confirmDeleteTimepass,fields:{id:"pass_id"}}},subscription:{editor:e("#lp_subscriptions"),template:e("#lp_js_subscriptionTemplate"),form:".lp_js_subscriptionEditorForm",editorContainer:".lp_js_subscriptionEditorContainer",id:".lp_js_subscriptionId",wrapper:".lp_js_subscriptionWrapper",categoryWrapper:".lp_js_subscriptionCategoryWrapper",fields:{duration:".lp_js_switchSubscriptionDuration",period:".lp_js_switchSubscriptionPeriod",scope:".lp_js_switchSubscriptionScope",scopeCategory:".lp_js_switchSubscriptionScopeCategory",categoryId:".lp_js_subscriptionCategoryId",title:".lp_js_subscriptionTitleInput",price:".lp_js_subscriptionPriceInput",description:".lp_js_subscriptionDescriptionTextarea"},classes:{form:"lp_js_subscriptionForm",editorForm:"lp_js_subscriptionEditorForm",durationClass:"lp_js_switchSubscriptionDuration",titleClass:"lp_js_subscriptionTitleInput",priceClass:"lp_js_subscriptionPriceInput",descriptionClass:"lp_js_subscriptionDescriptionTextarea",periodClass:"lp_js_switchSubscriptionPeriod",scopeClass:"lp_js_switchSubscriptionScope",scopeCategoryClass:"lp_js_switchSubscriptionScopeCategory"},preview:{placeholder:".lp_js_subscriptionPreview",wrapper:".lp_js_subscription",title:".lp_js_subscriptionPreviewTitle",description:".lp_js_subscriptionPreviewDescription",validity:".lp_js_subscriptionPreviewValidity",access:".lp_js_subscriptionPreviewAccess",price:".lp_js_subscriptionPreviewPrice",renewal:".lp_js_subscriptionPreviewRenewal"},actions:{create:e("#lp_js_addSubscription"),show:".lp_js_saveSubscription, .lp_js_cancelEditingSubscription",modify:".lp_js_editSubscription, .lp_js_deleteSubscription",save:".lp_js_saveSubscription",edit:".lp_js_editSubscription",cancel:".lp_js_cancelEditingSubscription","delete":".lp_js_deleteSubscription",flip:".lp_js_flipSubscription"},ajax:{form:{"delete":"subscription_delete"}},data:{id:"sub-id",list:lpVars.subscriptions_list,vouchers:lpVars.sub_vouchers_list,deleteConfirm:lpVars.i18n.confirmDeleteSubscription,fields:{id:"id"}}},voucherPriceInput:".lp_js_voucherPriceInput",generateVoucherCode:".lp_js_generateVoucherCode",voucherDeleteLink:".lp_js_deleteVoucher",voucherEditor:".lp_js_voucherEditor",voucherHiddenPassId:"#lp_js_timePassEditorHiddenPassId",voucherPlaceholder:".lp_js_voucherPlaceholder",voucherList:".lp_js_voucherList",voucher:".lp_js_voucher",editing:"lp_is-editing",unsaved:"lp_is-unsaved",payPerUse:"ppu",singleSale:"sis",selected:"lp_is-selected",disabled:"lp_is-disabled",hidden:"lp_hidden",navigation:e(".lp_navigation"),lp_make_post_free:e("#lp_make_post_free"),lp_disable_individual_purchase:e("#lp_disable_individual_purchase"),lp_set_inidvidual_price:e("#lp_set_individual_price"),lp_current_post_price_val:e('input[name="lp_current_post_price_val"]'),lp_global_price_section:e("#lp_js_globalPriceSection"),lp_global_revenue_section:e("#lp_js_globalRevenueSection"),lp_js_form_buttons_section:e("#lp_js_formButtons"),lp_js_globalPriceOptionZero:e("#lp_js_globalPriceOptionZero"),lp_js_globalPriceOptionOne:e("#lp_js_globalPriceOptionOne"),lp_js_globalPriceOptionTwo:e("#lp_js_globalPriceOptionTwo"),categoryButtonContainer:e("div.lp_js_categoryButtonContainer"),categoryPanelWarning:e("div.lp_js_categoryPanelWarning")},t=function(){i.body.on("change",i.revenueModelInput,function(){a(e(this).parents("form"))}),i.body.on("keyup",i.priceInput,M(function(){a(e(this).parents("form"))},1500)),i.editGlobalDefaultPrice.on("mousedown",function(){o()}).click(function(e){e.preventDefault()}),i.cancelEditingGlobalDefaultPrice.on("mousedown",function(){l()}).click(function(e){e.preventDefault()}),i.saveGlobalDefaultPrice.on("mousedown",function(){n()}).click(function(e){e.preventDefault()}),i.addCategory.on("mousedown",function(){c()}).click(function(e){e.preventDefault()}),i.body.on("click",i.editCategoryDefaultPrice,function(){var t=e(this).parents(i.categoryDefaultPriceForm);p(t)}),i.body.on("click",i.cancelEditingCategoryDefaultPrice,function(){var t=e(this).parents(i.categoryDefaultPriceForm);u(t)}),i.body.on("click",i.saveCategoryDefaultPrice,function(){var t=e(this).parents(i.categoryDefaultPriceForm),s=i.lp_current_post_price_val.val();return"1"===s?void u(t):void d(t)}),i.body.on("click",i.deleteCategoryDefaultPrice,function(){var t=e(this).parents(i.categoryDefaultPriceForm);_(t)}),i.timepass.actions.create.on("mousedown",function(){h("timepass")}).on("click",function(e){e.preventDefault()}),i.timepass.editor.on("mousedown",i.timepass.actions.edit,function(){b("timepass",e(this).parents(i.timepass.wrapper))}).on("click",i.timepass.actions.edit,function(e){e.preventDefault()}),i.timepass.editor.on("change",i.timepass.fields.revenueModel,function(){var t=e(this).parents("form");a(t,!1,e(i.timepass.fields.price,t))}),i.timepass.editor.on("change",i.timepass.fields.duration,function(){y("timepass",e(this).parents(i.timepass.wrapper),e(this))}),i.timepass.editor.on("change",i.timepass.fields.period,function(){k("timepass",e(this),e(this).parents(i.timepass.wrapper)),y("timepass",e(this).parents(i.timepass.wrapper),e(this))}),i.timepass.editor.on("change",i.timepass.fields.scope,function(){C("timepass",e(this)),y("timepass",e(this).parents(i.timepass.wrapper),e(this))}),i.timepass.editor.on("change",i.timepass.fields.scopeCategory,function(){y("timepass",e(this).parents(i.timepass.wrapper),e(this))}),i.timepass.editor.on("input",[i.timepass.fields.title,i.timepass.fields.description].join(),function(){y("timepass",e(this).parents(i.timepass.wrapper),e(this))}),i.timepass.editor.on("keyup",i.timepass.fields.price,M(function(){a(e(this).parents("form"),!1,e(this)),y("timepass",e(this).parents(i.timepass.wrapper),e(this))},1500)),i.timepass.editor.on("click",i.timepass.actions.cancel,function(t){e(i.timepass.actions.save).removeAttr("disabled"),e(i.timepass.actions.save).attr("href","#"),P("timepass",e(this).parents(i.timepass.wrapper)),t.preventDefault()}),i.timepass.editor.on("click",i.timepass.actions.save,function(t){return!e(this).is("[disabled=disabled]")&&(j("timepass",e(this).parents(i.timepass.wrapper)),void t.preventDefault())}),i.timepass.editor.on("click",i.timepass.actions["delete"],function(t){D("timepass",e(this).parents(i.timepass.wrapper)),t.preventDefault()}),i.timepass.editor.on("mousedown",i.timepass.actions.flip,function(){w("timepass",this)}).on("click",i.timepass.actions.flip,function(e){e.preventDefault()}),i.timepass.editor.on("keyup",i.voucherPriceInput,M(function(){a(e(this).parents("form"),!0,e(this))},1500)),i.timepass.editor.on("mousedown",i.generateVoucherCode,function(){x("timepass",e(this).parents(i.timepass.wrapper))}).on("click",i.generateVoucherCode,function(e){e.preventDefault()}),i.timepass.editor.on("click",i.voucherDeleteLink,function(i){V(e(this).parent()),i.preventDefault()}),i.timepass.editor.on("keyup",i.voucherPriceInput,function(t){s("timepass",e(this).parents(i.timepass.wrapper)),t.preventDefault()}),i.subscription.actions.create.on("mousedown",function(){h("subscription")}).on("click",function(e){e.preventDefault()}),i.subscription.editor.on("mousedown",i.subscription.actions.edit,function(){b("subscription",e(this).parents(i.subscription.wrapper))}).on("click",i.subscription.actions.edit,function(e){e.preventDefault()}),i.subscription.editor.on("change",i.subscription.fields.duration,function(){y("subscription",e(this).parents(i.subscription.wrapper),e(this))}),i.subscription.editor.on("change",i.subscription.fields.period,function(){k("subscription",e(this),e(this).parents(i.subscription.wrapper)),y("subscription",e(this).parents(i.subscription.wrapper),e(this))}),i.subscription.editor.on("change",i.subscription.fields.scope,function(){C("subscription",e(this)),y("subscription",e(this).parents(i.subscription.wrapper),e(this))}),i.subscription.editor.on("change",i.subscription.fields.scopeCategory,function(){y("subscription",e(this).parents(i.subscription.wrapper),e(this))}),i.subscription.editor.on("input",[i.subscription.fields.title,i.subscription.fields.description].join(),function(){y("subscription",e(this).parents(i.subscription.wrapper),e(this))}),i.subscription.editor.on("keyup",i.subscription.fields.price,M(function(){a(e(this).parents("form"),!0,e(this),!0),y("subscription",e(this).parents(i.subscription.wrapper),e(this))},1500)),i.subscription.editor.on("click",i.subscription.actions.cancel,function(t){e(i.subscription.actions.save).removeAttr("disabled"),e(i.subscription.actions.save).attr("href","#"),P("subscription",e(this).parents(i.subscription.wrapper)),t.preventDefault()}),i.subscription.editor.on("click",i.subscription.actions.save,function(t){return!e(this).is("[disabled=disabled]")&&(j("subscription",e(this).parents(i.subscription.wrapper)),void t.preventDefault())}),i.subscription.editor.on("click",i.subscription.actions["delete"],function(t){D("subscription",e(this).parents(i.subscription.wrapper)),t.preventDefault()}),i.subscription.editor.on("mousedown",i.subscription.actions.flip,function(){w("subscription",this)}).on("click",i.subscription.actions.flip,function(e){e.preventDefault()}),i.subscription.editor.on("keyup",i.voucherPriceInput,M(function(){a(e(this).parents("form"),!0,e(this),!0)},1500)),i.subscription.editor.on("mousedown",i.generateVoucherCode,function(){x("subscription",e(this).parents(i.subscription.wrapper))}).on("click",i.generateVoucherCode,function(e){e.preventDefault()}),i.subscription.editor.on("click",i.voucherDeleteLink,function(i){V(e(this).parent()),i.preventDefault()}),i.subscription.editor.on("keyup",i.voucherPriceInput,function(t){s("subscription",e(this).parents(i.subscription.wrapper)),t.preventDefault()}),i.lp_make_post_free.on("click",function(){return i.lp_global_price_section.hide(),i.lp_global_revenue_section.hide(),i.lp_js_form_buttons_section.css("float","right"),!0}),i.lp_disable_individual_purchase.on("click",function(){return i.lp_global_price_section.hide(),i.lp_global_revenue_section.hide(),i.lp_js_form_buttons_section.css("float","right"),!0}),i.lp_set_inidvidual_price.on("click",function(){return i.lp_global_price_section.show(),i.lp_global_revenue_section.show(),i.lp_js_form_buttons_section.css("float","none"),!0})},s=function(t,s){var a=!1;if("subscription"===t&&(a=!0),a){if(s.find(i.voucherPriceInput).val()>s.find(i.subscription.fields.price).val())return s.find(".lp_js_voucher_msg").text(lpVars.i18n.subVoucherMaximumPrice),void s.find(".lp_js_voucher_msg").css("display","block");if(s.find(i.voucherPriceInput).val()<lpVars.currency.sis_min)return s.find(".lp_js_voucher_msg").text(lpVars.i18n.subVoucherMinimum),void s.find(".lp_js_voucher_msg").css("display","block");e(i.subscription.actions.save).removeAttr("disabled"),e(i.subscription.actions.save).attr("href","#")}else{if(s.find(i.voucherPriceInput).val()>s.find(i.timepass.fields.price).val())return void s.find(".lp_js_voucher_msg").css("display","block");e(i.timepass.actions.save).removeAttr("disabled"),e(i.timepass.actions.save).attr("href","#")}s.find(".lp_js_voucher_msg").hide()},a=function(i,t,s,a){var o=s?s:e(".lp_number-input",i),l=o.val();return l=l.replace(/[^0-9\,\.]/g,""),l=parseFloat(l.replace(",",".")).toFixed(2),isNaN(l)&&(l=0),l=Math.abs(l),a?l<lpVars.currency.sis_min?l=lpVars.currency.sis_min:l>lpVars.currency.sis_max&&(l=lpVars.currency.sis_max):l>lpVars.currency.sis_max?l=lpVars.currency.sis_max:l>0&&l<lpVars.currency.ppu_min&&(l=lpVars.currency.ppu_min),t||r(l,i),l=l.toFixed(2),lpVars.locale.indexOf("de_DE")!==-1&&(l=l.replace(".",",")),o.val(l),l},r=function(t,s){var a,r=i.revenueModelInput;s.hasClass(i.timepass.classes.editorForm)&&(r=i.timepass.fields.revenueModel);var o=e(r+"[value="+i.payPerUse+"]",s),l=e(r+"[value="+i.singleSale+"]",s);a=e("input:radio:checked",s).val(),0===t||t>=lpVars.currency.ppu_min&&t<=lpVars.currency.ppu_max?(o.removeProp("disabled").parent("label").removeClass(i.disabled),l.parent("label").attr("data-tooltip",lpVars.i18n.payNowToolTip),l.parent("label").addClass("lp_tooltip"),o.parent("label").removeClass("lp_tooltip")):o.prop("disabled","disabled").parent("label").addClass(i.disabled),t>=lpVars.currency.sis_min?(l.removeProp("disabled").parent("label").removeClass(i.disabled),o.parent("label").attr("data-tooltip",lpVars.i18n.payLaterToolTip),o.parent("label").addClass("lp_tooltip"),l.parent("label").removeClass("lp_tooltip")):l.prop("disabled","disabled").parent("label").addClass(i.disabled),t>lpVars.currency.ppu_max&&a===i.payPerUse?l.prop("checked","checked"):t<lpVars.currency.sis_min&&a===i.singleSale&&o.prop("checked","checked"),e("label",s).removeClass(i.selected),e(r+":checked",s).parent("label").addClass(i.selected)},o=function(){i.globalDefaultPriceShowElements.velocity("slideUp",{duration:250,easing:"ease-out"}),i.globalDefaultPriceEditElements.velocity("slideDown",{duration:250,easing:"ease-out",complete:function(){setTimeout(function(){i.globalDefaultPriceInput.focus()},50)}}),i.globalDefaultPriceForm.addClass(i.editing)},l=function(){i.globalDefaultPriceShowElements.velocity("slideDown",{duration:250,easing:"ease-out"}),i.globalDefaultPriceEditElements.velocity("slideUp",{duration:250,easing:"ease-out"}),i.globalDefaultPriceForm.removeClass(i.editing),i.globalDefaultPriceInput.val(i.globalDefaultPriceDisplay.data("price"));var t=i.globalDefaultPriceRevenueModelDisplay.data("revenue");e(i.revenueModelLabel,i.globalDefaultPriceForm).removeClass(i.selected),e(".lp_js_revenueModelInput[value="+t+"]",i.globalDefaultPriceForm).prop("checked","checked").parent("label").addClass(i.selected);var s=i.lp_current_post_price_val.val();"2"===s?(i.lp_set_inidvidual_price.attr("checked","checked"),i.lp_disable_individual_purchase.removeProp("checked"),i.lp_make_post_free.removeProp("checked"),i.lp_global_price_section.show(),i.lp_global_revenue_section.show(),i.lp_js_form_buttons_section.css("float","none")):"1"===s?(i.lp_disable_individual_purchase.attr("checked","checked"),i.lp_set_inidvidual_price.removeProp("checked"),i.lp_make_post_free.removeProp("checked"),i.lp_global_price_section.hide(),i.lp_global_revenue_section.hide(),i.lp_js_form_buttons_section.css("float","right")):"0"===s&&(i.lp_make_post_free.attr("checked","checked"),i.lp_set_inidvidual_price.removeProp("checked"),i.lp_disable_individual_purchase.removeProp("checked"),i.lp_global_price_section.hide(),i.lp_global_revenue_section.hide(),i.lp_js_form_buttons_section.css("float","right"))},n=function(){var t=a(i.globalDefaultPriceForm);i.globalDefaultPriceInput.val(t),e.post(ajaxurl,i.globalDefaultPriceForm.serializeArray(),function(t){t.success&&(i.globalDefaultPriceDisplay.text(t.localized_price).data("price",t.price),i.globalDefaultPriceRevenueModelDisplay.text(t.revenue_model_label).data("revenue",t.revenue_model),2===t.post_price_behaviour?(i.lp_current_post_price_val.val("2"),i.lp_set_inidvidual_price.attr("checked","checked"),i.lp_disable_individual_purchase.removeProp("checked"),i.lp_make_post_free.removeProp("checked"),i.lp_global_price_section.show(),i.lp_global_revenue_section.show(),i.lp_js_form_buttons_section.css("float","none"),i.lp_js_globalPriceOptionTwo.show(),i.editGlobalDefaultPrice.css("padding","14px"),i.lp_js_globalPriceOptionOne.hide(),i.lp_js_globalPriceOptionZero.hide(),i.addCategory.removeAttr("disabled"),i.categoryButtonContainer.removeClass("lp_tooltip"),i.categoryPanelWarning.hide()):1===t.post_price_behaviour?(i.lp_current_post_price_val.val("1"),i.lp_disable_individual_purchase.attr("checked","checked"),i.lp_set_inidvidual_price.removeProp("checked"),i.lp_make_post_free.removeProp("checked"),i.lp_global_price_section.hide(),i.lp_global_revenue_section.hide(),i.lp_js_form_buttons_section.css("float","right"),i.lp_js_globalPriceOptionOne.show(),i.editGlobalDefaultPrice.css("padding","21px"),i.lp_js_globalPriceOptionTwo.hide(),i.lp_js_globalPriceOptionZero.hide(),i.addCategory.attr("disabled","disabled"),i.categoryButtonContainer.addClass("lp_tooltip"),e(i.categoryDefaultPriceForm+":visible").length>0&&i.categoryPanelWarning.show()):0===t.post_price_behaviour&&(i.lp_current_post_price_val.val("0"),i.lp_make_post_free.attr("checked","checked"),i.lp_set_inidvidual_price.removeProp("checked"),i.lp_disable_individual_purchase.removeProp("checked"),i.lp_global_price_section.hide(),i.lp_global_revenue_section.hide(),i.lp_js_form_buttons_section.css("float","right"),i.lp_js_globalPriceOptionZero.show(),i.editGlobalDefaultPrice.css("padding","21px"),i.lp_js_globalPriceOptionTwo.hide(),i.lp_js_globalPriceOptionOne.hide(),i.addCategory.removeAttr("disabled"),i.categoryButtonContainer.removeClass("lp_tooltip"),i.categoryPanelWarning.hide())),i.navigation.showMessage(t),l()},"json")},c=function(){var t=i.lp_current_post_price_val.val();if("1"!==t){i.addCategory.velocity("fadeOut",{duration:250}),e(i.emptyState,i.categoryDefaultPrices).is(":visible")&&e(i.emptyState,i.categoryDefaultPrices).velocity("fadeOut",{duration:400});var s=i.categoryDefaultPriceTemplate.clone().removeAttr("id").insertBefore("#lp_js_categoryDefaultPriceList").velocity("slideDown",{duration:250,easing:"ease-out"});p(s)}},p=function(t){e(".lp_js_categoryDefaultPriceForm.lp_is-editing").each(function(){u(e(this),!0)}),t.addClass(i.editing),e(i.categoryDefaultPriceShowElements,t).velocity("slideUp",{duration:250,easing:"ease-out"}),i.addCategory.velocity("fadeOut",{duration:250}),e(i.categoryDefaultPriceEditElements,t).velocity("slideDown",{duration:250,easing:"ease-out",complete:function(){e(i.categoryDefaultPriceInput,t).focus()}}),m(t,i.selectCategory,"laterpay_get_categories_with_price",f)},d=function(t){var s=a(t);e(i.categoryDefaultPriceInput,t).val(s),e.post(ajaxurl,t.serializeArray(),function(s){s.success&&(e(i.categoryDefaultPriceDisplay,t).text(s.localized_price).data("price",s.price),e(i.revenueModelLabelDisplay,t).text(s.revenue_model_label).data("revenue",s.revenue_model),e(i.categoryDefaultPriceInput,t).val(s.price),e(i.categoryTitle,t).text(s.category),e(i.categoryId,t).val(s.category_id),t.removeClass(i.unsaved)),u(t),i.navigation.showMessage(s)},"json")},u=function(t,s){if(t.removeClass(i.editing),t.hasClass(i.unsaved))t.velocity("slideUp",{duration:250,easing:"ease-out",complete:function(){e(this).remove(),0===e(i.categoryDefaultPriceForm+":visible").length&&e(i.emptyState,i.categoryDefaultPrices).velocity("fadeIn",{duration:400})}});else{e(i.categoryDefaultPriceEditElements,t).velocity("slideUp",{duration:250,easing:"ease-out"}),e(i.selectCategory,t).select2("destroy"),e(i.categoryDefaultPriceInput,t).val(e(i.categoryDefaultPriceDisplay,t).data("price"));var a=e(i.revenueModelLabelDisplay,t).data("revenue");e(i.revenueModelLabel,t).removeClass(i.selected),e(".lp_js_revenueModelInput[value="+a+"]",t).prop("checked","checked").parent("label").addClass(i.selected),e(i.categoryDefaultPriceShowElements,t).velocity("slideDown",{duration:250,easing:"ease-out"})}s||i.addCategory.velocity("fadeIn",{duration:250,display:"inline-block"})},_=function(t){a(t,!1,e("input[name=price]",t)),e("input[name=form]",t).val("price_category_form_delete"),e.post(ajaxurl,t.serializeArray(),function(s){s.success&&t.velocity("slideUp",{duration:250,easing:"ease-out",complete:function(){e(this).remove(),0===e(i.categoryDefaultPriceForm+":visible").length&&(e(i.emptyState,i.categoryDefaultPrices).velocity("fadeIn",{duration:400}),e(i.categoryPanelWarning).hide())}}),i.navigation.showMessage(s)},"json")},f=function(i,t){var s=e(t).parent().parent().parent();return e(".lp_js_selectCategory",s).val(i.text),e(".lp_js_categoryDefaultPriceCategoryId",s).val(i.id),i.text},v=function(t,s){var a=e(s).parents("form"),r=i.timepass;return e(a).hasClass(i.subscription.classes.editorForm)&&(r=i.subscription),t.id&&e(r.fields.categoryId,e(a)).val(t.id),e(r.fields.scopeCategory,e(a)).val(t.text),t.text},m=function(i,t,s,a){e(t,i).select2({allowClear:!0,ajax:{url:ajaxurl,data:function(e){return{form:s,term:e,action:"laterpay_pricing"}},results:function(i){var t=[];return e.each(i.categories,function(e){var s=i.categories[e];t.push({id:s.term_id,text:s.name})}),{results:t}},dataType:"json",type:"POST"},initSelection:function(i,t){var a=e(i).val();if(""!==a){var r={text:a};t(r)}else e.post(ajaxurl,{form:s,term:"",action:"laterpay_pricing"},function(e){if(e&&void 0!==e[0]){var i=e[0];t({id:i.term_id,text:i.name})}})},formatResult:function(e){return e.text},formatSelection:a,escapeMarkup:function(e){return e}})},h=function(t){var s=i[t];s.actions.create.velocity("fadeOut",{duration:250}),e(i.emptyState,s.editor).is(":visible")&&e(i.emptyState,s.editor).velocity("fadeOut",{duration:400}),e(s.wrapper).first().before(s.template.clone().removeAttr("id"));var a=e(s.wrapper,s.editor).first();e(s.form,a).addClass(i.unsaved),g(t,a),a.velocity("slideDown",{duration:250,easing:"ease-out",complete:function(){e(this).removeClass(i.hidden)}}).find(s.form).velocity("slideDown",{duration:250,easing:"ease-out",complete:function(){e(this).removeClass(i.hidden)}})},b=function(t,s){var a=i[t],r=e(a.form,a.template).clone();e(a.editorContainer,s).empty().append(r),g(t,s),e(a.actions.modify,s).addClass(i.hidden),e(a.actions.show,s).removeClass(i.hidden),r.removeClass(i.hidden)},g=function(t,s){var r=i[t],o=s.data(r.data.id),l=r.data.list[o],n="";if(l){if(e("input, select, textarea",s).each(function(i,t){n=e(t,s).attr("name"),""!==n&&void 0!==l[n]&&"revenue_model"!==n&&e(t,s).val(l[n])}),"timepass"===t){var c=r.data.vouchers[o];a(s.find("form"),!1,e(r.fields.price,s)),e(i.voucherPriceInput,s).val(e(r.fields.price,s).val()),e(i.revenueModelLabel,s).removeClass(i.selected);var p=e(r.fields.revenueModel+"[value="+l.revenue_model+"]",s);p.prop("checked","checked"),p.parent("label").addClass(i.selected),E(s),c instanceof Object&&e.each(c,function(e,i){T(e,i,s)})}else if("subscription"===t){var d=r.data.vouchers[o];a(s.find("form"),!0,e(r.fields.price,s),!0),e(i.voucherPriceInput,s).val(e(r.fields.price,s).val()),E(s),d instanceof Object&&e.each(d,function(e,i){T(e,i,s)})}e(r.categoryWrapper,s).hide(),m(s,r.fields.scopeCategory,"laterpay_get_categories",v);var u=e(r.fields.scope,s).find("option:selected");"0"!==u.val()&&e(r.categoryWrapper,s).show()}},y=function(t,s,a){var r=i[t],o=""!==a.val()?a.val():" ";if(a.hasClass(r.classes.durationClass)||a.hasClass(r.classes.periodClass)){var l=e(r.fields.duration,s).val(),n=e(r.fields.period,s).find("option:selected").text();n=parseInt(l,10)>1?n+"s":n,o=l+" "+n,e(r.preview.validity,s).text(o),"subscription"===t&&e(r.preview.renewal,s).text(lpVars.i18n.after+" "+o)}else if(a.hasClass(r.classes.scopeClass)||a.hasClass(r.classes.scopeCategoryClass)){var c=e(r.fields.scope,s).find("option:selected");o=c.text(),"0"!==c.val()&&(o+=" "+e(r.fields.scopeCategory,s).val()),e(r.preview.access,s).text(o)}else if(a.hasClass(r.classes.priceClass)){var p=e("<small />",{"class":"lp_purchase-link__currency"});p.text(lpVars.currency.code),e(".lp_js_purchaseLink",s).empty().append(o).append(p),e(r.preview.price).text(o+" "+lpVars.currency.code)}else a.hasClass(r.classes.titleClass)?e(r.preview.title,s).text(o):a.hasClass(r.classes.descriptionClass)&&e(r.preview.description,s).text(o)},P=function(t,s){var a=i[t],r=s.find(a.preview.wrapper).data(a.data.id);e(a.form,s).hasClass(i.unsaved)?s.velocity("fadeOut",{duration:250,complete:function(){e(this).remove(),0===e(a.wrapper+":visible").length&&e(i.emptyState,a.editor).velocity("fadeIn",{duration:400})}}):e(a.form,s).velocity("fadeOut",{duration:250,complete:function(){e(this).remove()}}),e(a.actions.modify,s).removeClass(i.hidden),e(a.actions.show,s).addClass(i.hidden),E(s),a.data.vouchers[r]instanceof Object&&(e.each(a.data.vouchers[r],function(e,i){S(e,i,s)}),s.find(i.voucherList).show()),a.actions.create.is(":hidden")&&a.actions.create.velocity("fadeIn",{duration:250,display:"inline-block"})},j=function(t,s){var a=i[t];e.post(ajaxurl,e(a.form,s).serializeArray(),function(t){if(t.success){var r=t.data[a.data.fields.id];a.data.vouchers[r]=t.vouchers,a.data.list[r]||(s.data(a.data.id,r),e(a.id,s).text(r).parent().velocity("fadeIn",{duration:250})),a.data.list[r]=t.data,e(a.preview.placeholder,s).empty().append(t.html),e(a.actions.show,s).addClass(i.hidden),e(a.actions.modify,s).removeClass(i.hidden),e(a.form,s).velocity("fadeOut",{duration:250,complete:function(){e(this).remove(),I(s,a,r)}}),a.actions.create.is(":hidden")&&a.actions.create.velocity("fadeIn",{duration:250,display:"inline-block"})}i.navigation.showMessage(t)},"json")},D=function(t,s){var a=i[t];confirm(a.data.deleteConfirm)&&s.velocity("slideUp",{duration:250,easing:"ease-out",begin:function(){e.post(ajaxurl,{action:"laterpay_pricing",form:a.ajax.form["delete"],id:s.data(a.data.id)},function(t){t.success?(s.remove(),0===e(a.wrapper+":visible").length&&e(i.emptyState,a.editor).velocity("fadeIn",{duration:400})):e(this).stop().show(),i.navigation.showMessage(t)},"json")}})},w=function(t,s){e(s).parents(i[t].preview.wrapper).toggleClass("lp_is-flipped")},C=function(t,s){var a=i[t],r=e("option:selected",s).val();"0"===r?e(a.categoryWrapper).hide():e(a.categoryWrapper).show()},k=function(t,s,a){var r,o=i[t],l=[],n=24,c=s.val(),p=e(o.fields.duration,a).val();for("4"===c?n=1:"3"===c&&(n=12),r=1;r<=n;r++){var d=e("<option/>",{value:r});d.text(r),l.push(d)}e(o.fields.duration,a).find("option").remove().end().append(l).val(p&&p<=n?p:1)},I=function(t,s,a){E(t),s.data.vouchers[a]instanceof Object&&(e.each(s.data.vouchers[a],function(e,i){S(e,i,t)}),t.find(i.voucherList).show())},x=function(t,s){var r=!1;if("subscription"===t&&(r=!0),a(s,!0,e(".lp_js_voucherPriceInput",s),r),r){if(s.find(i.voucherPriceInput).val()>s.find(i.subscription.fields.price).val())return e(i.subscription.actions.save).attr("disabled","disabled"),e(i.subscription.actions.save).removeAttr("href"),void s.find(".lp_js_voucher_msg").css("display","block");e(i.subscription.actions.save).removeAttr("disabled"),e(i.subscription.actions.save).attr("href","#")}else{if(s.find(i.voucherPriceInput).val()>s.find(i.timepass.fields.price).val())return e(i.timepass.actions.save).attr("disabled","disabled"),e(i.timepass.actions.save).removeAttr("href"),void s.find(".lp_js_voucher_msg").css("display","block");e(i.timepass.actions.save).removeAttr("disabled"),e(i.timepass.actions.save).attr("href","#")}s.find(".lp_js_voucher_msg").hide(),e.post(ajaxurl,{form:"generate_voucher_code",action:"laterpay_pricing",price:s.find(i.voucherPriceInput).val()},function(e){e.success?T(e.code,s.find(i.voucherPriceInput).val(),s):i.navigation.showMessage(e)},"json")},T=function(t,s,a){var r=s.price?s.price:s,o=r+" "+lpVars.currency.code,l=s.title?s.title:"",n=e("<div/>",{"class":"lp_js_voucher lp_voucher","data-code":t,style:"display:none;"}),c=e("<input/>",{type:"hidden",name:"voucher_code[]",value:t}),p=e("<input/>",{type:"hidden",name:"voucher_price[]",value:r}),d=e("<span/>",{"class":"lp_voucher__code"}).text(t),u=e("<span/>",{"class":"lp_voucher__code-infos"}).text(lpVars.i18n.voucherText+" "+o),_=e("<input/>",{"class":"lp_input__title",type:"text",name:"voucher_title[]",value:l}),f=e("<a/>",{"class":"lp_js_deleteVoucher lp_edit-link--bold","data-icon":"g"});n.empty().append(c).append(p).append(d).append(u).append(_).append(f),a.find(i.voucherPlaceholder).prepend(n).find("div").first().velocity("slideDown",{duration:250,easing:"ease-out"})},S=function(t,s,a){var r=s.title?s.title:"",o=s.price+" "+lpVars.currency.code,l=e("<div/>",{"class":"lp_js_voucher lp_voucher","data-code":t}),n=e("<span/>",{"class":"lp_voucher__title"}).append(e("<b/>").text(r)),c=e("<span/>",{"class":"lp_voucher__code"}).text(t),p=e("<span/>",{"class":"lp_voucher__code-infos"}).text(lpVars.i18n.voucherText+" "+o),d=e("<div/>").append(c).append(p);l.append(n).append(d),a.find(i.voucherList).append(l)},E=function(e){e.find(i.voucher).remove()},V=function(i){i.velocity("slideUp",{duration:250,easing:"ease-out",complete:function(){e(this).remove()}})},M=function(e,i){var t;return function(){var s=this,a=arguments;clearTimeout(t),t=setTimeout(function(){e.apply(s,a)},i)}},O=function(){t()};O()}i()})}(jQuery);